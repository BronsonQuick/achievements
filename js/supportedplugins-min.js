/*global Socialite*/(function(a){function b(b,c,d){b.preventDefault();b.stopImmediatePropagation();var e=a("#dpa-toolbar-filter").val(),f=a("#dpa-toolbar-search").val(),g=null,h="",i=a("#post-body-content > .current").prop("class");if(i.indexOf("grid")>=0){i="grid";h="#post-body-content > .grid a"}else if(i.indexOf("list")>=0){i="list";h="#post-body-content > .list tbody tr"}else if(i.indexOf("detail")>=0){i="detail";h="#post-body-content > .detail > ul li"}a(h).each(function(){g=a(this);"1"===e?g.hasClass("installed")?g.addClass("showme"):g.addClass("hideme"):"0"===e?g.hasClass("notinstalled")?g.addClass("showme"):g.addClass("hideme"):g.addClass("showme")});a(h+":not(.hideme)").each(function(){g=a(this);if("grid"===i&&g.children("img").prop("alt").search(new RegExp(f,"i"))<0||"list"===i&&g.children(".name").text().search(new RegExp(f,"i"))<0||"detail"===i&&g.prop("class").search(new RegExp(f,"i"))<0){g.removeClass("showme");g.addClass("hideme")}});a(h).each(function(){g=a(this);g.hasClass("showme")?g.show():g.hasClass("hideme")&&g.fadeOut();g.removeClass("hideme").removeClass("showme")});a.cookie("dpa_sp_filter",e,{path:"/"})}function c(c,d){c=a.trim(c);a("#post-body-content > .current, #dpa-toolbar-views li.current").removeClass("current");a("#post-body-content > ."+c).addClass("current");a("#dpa-toolbar-views li a."+c).parent().addClass("current");b(d);a.cookie("dpa_sp_view",c,{path:"/"})}function d(b){b+=" ";b=b.substr(0,b.indexOf(" "));a("#dpa-details-plugins option:selected").prop("selected",!1);a("#dpa-details-plugins ."+b).prop("selected",!0);a("#dpa-detail-contents > div").removeClass("current");a("#dpa-detail-contents ."+b).addClass("current");a.cookie("dpa_sp_lastplugin",b,{path:"/"})}a(document).ready(function(){a("#dpa-details-plugins").on("click.achievements",function(b){b.preventDefault();d(a(this).children(":selected").prop("class"))});a("#post-body-content > .list .plugin img").on("click.achievements",function(b){b.preventDefault();c("detail",b);d(a(this).prop("class"))});a("#post-body-content > .grid a").on("click.achievements",function(b){b.preventDefault();c("detail",b);d(a(this).children("img").prop("class"))});a("#dpa-toolbar-wrapper li a").on("click.achievements",function(b){a(this).hasClass("current")||c(a(this).prop("class"),b)});a("#dpa-toolbar").submit(function(b){b.stopPropagation();b.preventDefault();if(1===a("div.current a:visible").size()&&"detail"!==a("#post-body-content > .current").prop("class").trim()&&"list"!==a("#post-body-content > .current").prop("class").trim()){var e=a("#post-body-content > .grid a:visible img");a("#dpa-toolbar-search").val("");c("detail",b);d(e.prop("class"))}});a("#dpa-toolbar-filter").on("change.achievements",b);a("#dpa-toolbar-search").on("keyup.achievements",b);a("#post-body-content .list table").tablesorter({headers:{0:{sorter:!1},1:{sorter:!1},4:{sorter:!1}},textExtraction:function(a){return a.innerHTML}});a("#post-body-content .list table th a").on("click.achievements",function(a){a.preventDefault()});Socialite.load(a("#dpa-detail-contents h3"))})})(jQuery);